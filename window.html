<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <title>Error Window</title>
  <style>
    .win-old-btn {
      position: absolute;
      top: 100px;
      left: 220px;
      background: #c0c0c0;
      border: 2px outset #fff;
      padding: 5px 20px;
      font-family: "Tahoma", sans-serif;
      font-size: 18px;
      color: black;
      cursor: pointer;
      outline: none;
      box-shadow: inset 1px 1px 0 #fff, inset -1px -1px 0 #404040;
      user-select: none;
      transition: none;
    }

    .win-old-btn:active {
      border-style: inset;
      box-shadow: inset -1px -1px 0 #fff, inset 1px 1px 0 #404040;
    }
.error-row {
  display: flex;
  align-items: flex-start;  /* 上揃え（Windows風） */
  gap: 10px;                /* 画像と文字の間隔 */
}

#myImage {
  width: 20px;
  height: 20px;
  object-fit: contain;
}

.error-text {
  text-align: left;         /* ← ここが重要 */
  font-family: Tahoma, sans-serif;
  font-size: 14px;
  line-height: 1.4;
  max-width: 220px;         /* 長文折り返し用 */
}
    
  </style>
</head>

<body>
<div class="error-row">
  <img id="myImage">
  <div class="error-text">
    エラーが発生しました。<br>
    再起動してください。
  </div>
</div>
  <button class="win-old-btn" onclick="window.close()">OK</button>

  <script>
    window.onload = function () {
      const params = new URLSearchParams(window.location.search);

      const xp = Number(params.get('xp'));
      const yp = Number(params.get('yp'));
      const cos = params.get('cos');
console.log("cos =", cos);
      const x = (xp + 240) / 480 * window.innerWidth;
      const y = (yp + 180) / 360 * window.innerHeight;
      window.resizeTo(300, 140);
      window.moveTo(x, y);

      const url = `https://yamatya-s2.github.io/error408/window_image/${cos}.png`;
      document.getElementById("myImage").src = url;

      const timeStr = params.get('time'); 

      if (timeStr) {
        const timeArray = timeStr.split(':').map(x => parseInt(x, 10));

        const targetDate = new Date(
          timeArray[0] || new Date().getFullYear(),  
          (timeArray[1] ? timeArray[1] - 1 : 0),    
          timeArray[2] || 1,                        
          timeArray[3] || 0,                        
          timeArray[4] || 0,                        
          timeArray[5] || 0,                        
          timeArray[6] || 0                         
        );

        const now = new Date();
        const diff = targetDate - now;

        if (diff > 0) {
          setTimeout(() => {
            window.close();
          }, diff);
        } else {
          window.close();
        }
      }
    };
  </script>
</body>
